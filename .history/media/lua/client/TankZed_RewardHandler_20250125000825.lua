--[[██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                        				 Custom  PZ  Mod  Developer  for  Hire													  |
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                       		 Portfolio:  https://steamcommunity.com/id/glytch3r/myworkshopfiles/							  |
|                       		 Discord:    Glytch3r#1337 / glytch3r															  |
|                       		 Support:    https://ko-fi.com/glytch3r														 	  |
|_________________________________________________________________________________________________________________________________|
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████-]]

----------------------------------------------------------------------------------------------------------------------------------



TankZedModII = TankZedModII or {}




function TankZedModII.getRewardRoll(num)
	local chance = TankZedModII.getDeathRewards(num)
	if chance == 0 then return false end
	if chance == 100 then return true end
	return TankZedModII.doRoll(chance)
end

function TankZedModII.getLootRate(zed)

end
function TankZedModII.getDeathRewards(num)
    num = num or 1
    str = str or "LootRate"
    local tab = {
        [1] = 	{

            ['LootRate'] = SandboxVars.TankZedModII_1.LootRate or 50,
            ['DropList'] = SandboxVars.TankZedModII_1.DropList or "Base.Katana;Base.Sledgehammer2",


        },

        [2] = 	{

            ['LootRate'] = SandboxVars.TankZedModII_2.LootRate or 50,
            ['DropList'] = SandboxVars.TankZedModII_2.DropList or "Base.SpiffoTail;Base.SpiffoSuit",
        }
    }
    return tab[tonumber(2)]
end




function TankZedModII.deadZedLoot(zed)

	if TankZedModII.isTankZed(zed) then
		local attacker = zed:getAttackedBy()
		if attacker and attacker == getPlayer() then

			zed:getEmitter():stopAll()
			zed:getEmitter():playSound('TankZed_Death')

			local shouldPlaySfx = SandboxVars.TankZedModII.VictorySfx or true

			if shouldPlaySfx then
				timer:Simple(3, function()
					getSoundManager():playUISound("GainExperienceLevel")
				end)
			end

			local num = TankZedModII.getTankZedNum(zed)
			local sq = zed:getSquare()
			if sq and num then
				TankZedModII.SpawnRewards(sq, num)
			end
		end
	end
end
Events.OnZombieDead.Remove(TankZedModII.deadZedLoot)
Events.OnZombieDead.Add(TankZedModII.deadZedLoot)

function TankZedModII.parseItems(DropList)
    local tab = {}
    for item in string.gmatch(DropList, "([^;]+)") do
        table.insert(tab, item)
    end
    return tab
end
function TankZedModII.SpawnRewards(sq, num)
	local DropList = TankZedModII.getDeathRewards(num).DropList
    local LootRate =  TankZedModII.getDeathRewards(num).LootRate
    if not sq then return end
    if DropList and LootRate then
        local itemList = TankZedModII.parseItems(DropList)
        for _, item in ipairs(itemList) do
            local shouldSpawn = (LootRate == 100 or ZombRand(100) <= LootRate)
            if shouldSpawn then
                sq:AddWorldInventoryItem(item, ZombRand(0.1, 0.5), ZombRand(0.1, 0.5), 0)
            end
        end
    end
end
--[[

function TankZedModII.RewardHandler(zed)
	if TankZedModII.isDogZed(zed) then
        TankZedModII.SpawnRewards(sq)
    end
end
Events.OnZombieDead.Remove(TankZedModII.RewardHandler)
Events.OnZombieDead.Add(TankZedModII.RewardHandler)
 ]]


